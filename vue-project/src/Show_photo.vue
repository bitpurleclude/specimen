<script setup>
import { onMounted, ref, watch } from 'vue'
import url from '@/2.png'
const image_url = ref(url)
const svgData = ref("M288 429 L288 429 L288 428 L288 427 L288 426 L288 425 L287 424 L287 423 L287 421 L286 421 L286 419 L285 417 L285 417 L285 416 L284 416 L284 415 L284 414 L284 413 L284 413 L284 412 L283 412 L283 411 L283 410 L283 409 L283 409 L282 409 L282 408 L282 407 L282 406 L282 405 L282 405 L281 405 L281 404 L281 403 L281 402 L281 401 L280 401 L280 401 L280 400 L280 399 L280 398 L280 397 L280 397 L280 397 L280 396 L280 395 L280 394 L280 393 L280 393 L280 392 L279 392 L279 391 L279 390 L279 389 L279 389 L279 388 L279 387 L279 386 L279 385 L279 385 L279 384 L279 383 L279 382 L279 381 L279 381 L279 380 L279 379 L279 378 L279 377 L279 377 L279 376 L279 375 L279 376 L278 376 L278 377 L278 377 L278 378 L277 378 L277 379 L277 380 L277 381 L276 381 L276 382 L276 383 L276 384 L276 385 L276 385 L276 386 L276 386 L276 387 L276 388 L275 388 L275 389 L275 389 L274 389 L274 390 L273 391 L272 391 L272 392 L272 392 L272 393 L271 393 L271 393 L270 393 L269 394 L268 394 L268 395 L268 395 L267 395 L267 396 L266 396 L266 397 L265 397 L265 397 L264 397 L264 397 L264 398 L263 398 L263 397 L263 397 L263 396 L263 395 L263 393 L263 393 L263 392 L263 390 L263 389 L263 388 L263 387 L263 386 L263 385 L264 384 L264 383 L264 382 L264 381 L264 381 L264 381 L264 380 L264 379 L265 378 L265 377 L265 377 L265 376 L265 375 L265 374 L266 373 L266 373 L266 372 L267 372 L267 371 L267 370 L267 369 L268 369 L268 369 L268 368 L268 368 L268 367 L269 366 L269 365 L269 365 L270 365 L270 364 L270 363 L271 363 L271 362 L271 361 L271 361 L272 361 L272 360 L272 359 L272 358 L272 357 L272 357 L272 356 L272 355 L272 354 L272 353 L271 353 L271 353 L270 353 L270 352 L270 351 L269 351 L269 350 L268 350 L268 349 L268 349 L268 349 L268 348 L268 347 L267 346 L267 345 L266 345 L266 344 L266 343 L265 343 L265 342 L265 341 L264 341 L264 341 L264 340 L264 339 L264 339 L264 338 L264 337 L263 337 L263 337 L263 336 L263 335 L263 334 L262 333 L262 333 L262 332 L261 332 L261 331 L261 330 L260 330 L260 329 L260 329 L260 328 L259 328 L259 327 L258 327 L258 326 L257 326 L257 325 L256 325 L256 325 L256 325 L256 324 L255 324 L255 323 L254 323 L254 322 L253 322 L252 321 L252 321 L252 321 L251 321 L251 320 L250 319 L250 318 L249 318 L249 317 L248 317 L248 317 L248 317 L248 316 L247 315 L247 314 L247 313 L246 313 L246 313 L246 312 L246 311 L245 311 L245 310 L245 309 L245 309 L245 308 L245 307 L245 306 L245 305 L244 305 L244 304 L244 303 L244 302 L244 301 L244 301 L244 300 L244 299 L244 298 L243 298 L243 297 L243 297 L243 296 L243 295 L243 294 L243 293 L243 293 L243 292 L243 291 L243 290 L243 289 L243 289 L243 288 L243 287 L243 286 L243 285 L243 285 L243 284 L243 283 L243 282 L243 281 L243 281 L243 280 L243 279 L243 278 L243 277 L243 277 L243 276 L243 275 L243 274 L243 273 L243 273 L243 272 L243 271 L243 270 L243 269 L243 269 L243 268 L243 267 L243 266 L243 265 L243 265 L243 264 L243 263 L243 262 L243 261 L243 261 L243 260 L243 259 L243 258 L243 257 L243 257 L243 256 L243 255 L244 255 L244 254 L244 253 L244 253 L244 252 L244 251 L244 250 L244 249 L244 249 L244 248 L244 247 L244 246 L244 245 L244 245 L244 244 L244 243 L244 242 L244 241 L244 241 L244 241 L244 240 L244 239 L244 238 L244 237 L244 237 L245 236 L245 235 L245 234 L245 233 L245 233 L245 232 L246 232 L246 231 L246 230 L246 229 L246 229 L246 228 L246 227 L247 226 L247 225 L247 225 L247 224 L247 223 L247 222 L247 221 L247 221 L247 220 L247 219 L247 218 L247 217 L247 217 L247 216 L247 215 L247 214 L247 213 L247 213 L247 212 L248 212 L248 211 L248 210 L248 209 L248 209 L248 208 L248 207 L249 207 L249 206 L249 205 L250 205 L250 205 L251 204 L251 203 L252 202 L252 201 L252 201 L252 201 L253 201 L253 200 L254 200 L254 199 L254 198 L255 198 L255 197 L255 197 L256 197 L256 196 L256 195 L256 194 L257 193 L257 193 L258 193 L258 192 L258 191 L259 191 L259 190 L259 189 L259 189 L260 188 L260 187 L260 186 L260 185 L260 185 L260 184 L260 183 L260 182 L261 182 L261 181 L261 181 L261 180 L261 179 L261 178 L262 177 L262 177 L262 176 L262 175 L262 174 L262 173 L262 173 L262 172 L262 171 L262 170 L263 170 L263 169 L263 169 L263 168 L263 167 L263 166 L263 165 L263 165 L263 164 L263 163 L263 162 L264 162 L264 161 L264 161 L264 160 L264 159 L264 158 L264 157 L264 157 L264 156 L264 155 L264 154 L264 153 L264 153 L264 152 L264 151 L264 150 L264 149 L264 149 L263 148 L263 147 L263 146 L263 145 L263 145 L263 144 L263 143 L263 142 L263 141 L263 141 L263 140 L263 139 L263 138 L263 137 L262 137 L262 137 L262 136 L262 135 L262 134 L262 133 L262 133 L262 132 L262 131 L262 130 L262 129 L262 129 L263 128 L263 127 L264 127 L264 126 L265 126 L266 126 L267 126 L268 126 L268 126 L269 127 L270 127 L271 127 L272 128 L272 128 L273 128 L273 129 L274 129 L274 129 L275 129 L275 130 L276 131 L276 132 L276 132 L276 133 L277 133 L277 134 L278 135 L279 136 L279 137 L280 137 L280 137 L280 137 L281 138 L282 139 L283 139 L283 140 L284 141 L284 141 L284 141 L284 142 L285 142 L285 143 L286 143 L286 144 L287 144 L288 145 L288 145 L289 145 L289 146 L290 146 L290 147 L291 147 L291 148 L292 148 L292 148 L292 149 L293 149 L294 149 L295 149 L295 150 L296 150 L296 151 L297 151 L297 150 L298 149 L298 149 L299 148 L300 147 L300 146 L300 146 L300 145 L301 145 L302 145 L303 145 L304 144 L304 144 L305 144 L306 144 L307 143 L308 143 L308 143 L309 143 L310 143 L311 143 L312 143 L312 143 L313 143 L314 143 L315 143 L316 143 L316 143 L317 143 L319 143 L320 143 L320 143 L321 143 L322 143 L324 143 L324 143 L325 143 L326 143 L327 143 L328 143 L328 143 L329 143 L330 143 L331 143 L332 143 L332 143 L333 143 L334 143 L335 143 L336 143 L336 143 L337 143 L338 143 L340 142 L340 142 L341 142 L342 141 L343 141 L344 141 L346 140 L348 139 L349 138 L351 137 L352 137 L352 136 L352 136 L352 135 L352 134 L352 134 L350 133 L349 133 L348 132 L348 131 L347 130 L346 129 L346 129 L346 128 L345 128 L345 127 L345 126 L345 125 L344 125 L344 123 L344 122 L344 121 L344 121 L344 119 L344 118 L345 117 L345 117 L346 116 L346 115 L347 114 L348 114 L348 113 L348 113 L348 113 L348 112 L349 112 L349 111 L350 111 L350 110 L351 110 L352 110 L352 109 L353 109 L354 109 L355 109 L356 109 L356 109 L356 109 L357 109 L359 109 L360 109 L360 109 L361 109 L362 109 L363 109 L364 109 L364 109 L365 109 L366 109 L367 109 L368 109 L368 109 L369 108 L370 108 L370 107 L371 107 L371 106 L372 106 L372 107 L372 108 L372 109 L372 111 L373 113 L373 115 L373 117 L373 118 L373 121 L374 123 L374 125 L374 126 L374 128 L375 129 L375 130 L375 132 L375 133 L375 133 L375 134 L375 135 L376 136 L376 137 L376 137 L376 138 L376 139 L376 139 L376 140 L376 141 L376 141 L376 142 L377 142 L377 143 L377 144 L377 145 L377 145 L378 145 L378 146 L378 147 L378 148 L379 148 L379 149 L379 149 L380 149 L380 150 L380 151 L380 152 L381 152 L381 153 L381 153 L382 153 L382 154 L383 154 L383 155 L384 156 L384 157 L384 157 L384 157 L385 157 L385 158 L386 158 L386 159 L387 159 L387 160 L388 160 L388 161 L388 161 L388 161 L388 162 L389 163 L389 164 L390 164 L391 165 L391 165 L392 166 L392 167 L392 167 L392 168 L393 169 L393 169 L394 169 L394 170 L394 171 L395 172 L395 173 L395 173 L396 173 L396 174 L396 175 L396 176 L396 177 L396 177 L396 178 L396 179 L396 180 L397 181 L398 181 L398 182 L398 183 L399 184 L400 185 L400 186 L400 187 L400 188 L401 189 L402 189 L402 190 L403 191 L404 192 L404 193 L404 193 L404 194 L405 195 L405 196 L406 196 L406 197 L407 197 L407 198 L408 198 L408 199 L408 200 L408 201 L408 201 L409 201 L409 203 L409 204 L410 205 L410 205 L411 206 L412 208 L412 209 L412 209 L412 210 L413 211 L413 212 L413 213 L414 213 L414 214 L415 214 L415 215 L416 216 L416 217 L416 217 L416 218 L416 218 L416 219 L417 220 L417 221 L417 221 L418 221 L418 222 L418 223 L418 224 L419 224 L419 225 L419 225 L419 226 L419 227 L420 227 L420 228 L420 229 L420 229 L420 230 L420 231 L420 232 L420 233 L420 233 L420 234 L420 235 L420 236 L420 237 L420 237 L420 238 L420 239 L420 240 L420 241 L420 241 L420 242 L420 243 L420 244 L420 245 L420 245 L420 246 L420 248 L420 249 L420 250 L420 251 L420 253 L420 253 L420 254 L420 256 L420 257 L420 257 L420 259 L420 260 L420 261 L419 262 L419 264 L419 265 L419 266 L419 268 L419 269 L419 270 L419 272 L419 273 L419 274 L419 275 L418 277 L418 277 L418 279 L418 280 L418 281 L418 282 L418 283 L417 284 L417 285 L417 285 L417 287 L416 288 L416 289 L416 290 L416 291 L416 293 L416 293 L416 295 L416 296 L415 297 L415 297 L415 298 L415 299 L414 300 L414 301 L414 301 L413 301 L413 302 L413 303 L412 303 L412 304 L412 305 L412 305 L412 305 L412 306 L412 307 L411 307 L411 308 L411 309 L410 309 L410 309 L409 309 L409 310 L409 311 L409 312 L408 312 L408 313 L408 313 L408 313 L408 314 L408 315 L408 316 L407 316 L407 317 L407 317 L407 318 L407 319 L407 320 L408 320 L408 321 L408 321 L408 322 L408 322 L408 323 L408 324 L409 324 L409 325 L409 325 L409 326 L410 327 L410 328 L410 329 L411 329 L411 330 L412 331 L412 332 L412 333 L412 333 L412 334 L412 335 L412 336 L412 337 L413 337 L413 337 L413 338 L413 339 L414 340 L414 341 L414 341 L414 342 L415 342 L415 343 L415 344 L415 345 L416 345 L416 346 L416 347 L416 348 L416 348 L416 349 L416 349 L416 350 L417 351 L417 352 L417 353 L417 353 L417 354 L417 355 L418 355 L418 356 L418 357 L418 357 L418 358 L418 359 L417 359 L416 357 L415 357 L414 356 L413 355 L412 354 L411 353 L410 352 L409 351 L408 350 L408 349 L407 349 L406 348 L406 347 L405 346 L404 346 L404 345 L404 345 L404 344 L403 344 L403 343 L402 343 L402 344 L402 345 L402 346 L402 348 L402 349 L402 350 L402 352 L402 353 L402 354 L402 355 L402 356 L402 357 L401 357 L401 358 L401 359 L401 360 L401 361 L400 361 L400 362 L400 363 L400 364 L400 364 L400 365 L400 366 L399 367 L399 368 L398 369 L398 369 L398 370 L397 371 L397 372 L396 373 L396 373 L396 374 L396 375 L396 376 L396 377 L396 377 L396 378 L396 379 L396 380 L395 380 L395 381 L395 381 L395 382 L395 383 L395 384 L395 385 L395 385 L395 386 L395 387 L395 388 L395 389 L395 389 L395 390 L395 391 L395 392 L395 393 L395 393 L395 394 L395 395 L395 396 L395 397 L395 397 L395 398 L394 399 L394 400 L394 401 L394 401 L394 402 L393 403 L393 404 L393 405 L393 405 L392 406 L392 407 L392 408 L392 409 L392 410 L392 411 L391 411 L391 412 L391 413 L390 413 L390 414 L390 415 L389 417 L389 417 L389 418 L388 419 L388 420 L388 421 L388 421 L388 421 L388 422 L387 422 L387 423 L386 424 L386 425 L386 425 L385 425 L385 426 L385 427 L384 427 L384 428 L384 429 L384 429 L384 430 L383 430 L383 431 L383 432 L382 433 L382 433 L381 433 L381 434 L381 435 L380 435 L380 436 L380 437 L380 437 L380 437 L380 438 L379 438 L379 439 L378 440 L378 441 L378 441 L377 442 L377 443 L376 444")
//获取img大小
const imageSize = ref({ left: 0, top: 0, width: 0, height: 0, realWidth: 0, realHeight: 0, xScale: 1, yScale: 1 });
const imgRef = ref(null);
// 更新imgSize函数，使用imgRef元素
const imgSize = () => {
  if (imgRef.value) {
    let img = imgRef.value;
    img.onload = function () {
      imageSize.value = {
        width: img.offsetWidth,
        height: img.offsetHeight,
        realWidth: img.naturalWidth,
        realHeight: img.naturalHeight,
        xScale: img.offsetWidth / img.Width,
        yScale: img.offsetHeight / img.Height,
        left: img.offsetLeft,
        top: img.offsetTop
      };
    };
  }
};
onMounted(() => {
  imgSize();
  // 如果图片地址可能会动态改变，可以添加watch监听
  watch(
    () => image_url.value,
    () => {
      imgSize();
    },
    { immediate: true }
  );
});
</script>

<template>
  <div>
    <!-- 渲染图片 -->
    <img ref="imgRef" :src="image_url" alt="..." style="position: relative;" :width="500" :height="500"/>
    <!-- 渲染SVG，根据imageSize进行缩放和定位 -->
    <svg :width="imageSize.width" :height="imageSize.height"
      :view-box="`0 0 ${imageSize.Width} ${imageSize.Height}`" xmlns="http://www.w3.org/2000/svg"
      :style="{ position: 'absolute', left: `${imageSize.left}px`, top: `${imageSize.top}px` }">
      <g :transform="`scale(${imageSize.xScale}, ${imageSize.yScale})`">
        <path :d="svgData" stroke="black" fill="none" stroke-width="2"></path>
      </g>
    </svg>
  </div>
</template>